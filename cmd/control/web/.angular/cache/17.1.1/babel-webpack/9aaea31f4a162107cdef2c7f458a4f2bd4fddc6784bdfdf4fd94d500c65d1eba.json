{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/jpeery1/Desktop/byuoitav/camera-services/cmd/control/web/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { EventEmitter } from '@angular/core';\nimport { ErrorDialog } from \"../../dialogs/error/error.dialog\";\nimport { JwtHelperService } from '@auth0/angular-jwt';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../services/api.service\";\nimport * as i3 from \"@angular/material/dialog\";\nimport * as i4 from \"ngx-cookie-service\";\nimport * as i5 from \"@angular/material/form-field\";\nimport * as i6 from \"@angular/material/snack-bar\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"@angular/material/button\";\nimport * as i9 from \"@angular/forms\";\nimport * as i10 from \"@angular/material/input\";\nconst _c0 = [\"form\"];\nfunction LoginComponent_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 9);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r1.key[0] ? ctx_r1.key[0] : \" \");\n  }\n}\nfunction LoginComponent_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r2.key[0] ? ctx_r2.key[0] : \" \");\n  }\n}\nfunction LoginComponent_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 9);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r3.key[1] ? ctx_r3.key[1] : \" \");\n  }\n}\nfunction LoginComponent_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r4.key[1] ? ctx_r4.key[1] : \" \");\n  }\n}\nfunction LoginComponent_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 9);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r5.key[2] ? ctx_r5.key[2] : \" \");\n  }\n}\nfunction LoginComponent_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r6.key[2] ? ctx_r6.key[2] : \" \");\n  }\n}\nfunction LoginComponent_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 9);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r7 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r7.key[3] ? ctx_r7.key[3] : \" \");\n  }\n}\nfunction LoginComponent_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r8.key[3] ? ctx_r8.key[3] : \" \");\n  }\n}\nfunction LoginComponent_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 9);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r9 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r9.key[4] ? ctx_r9.key[4] : \" \");\n  }\n}\nfunction LoginComponent_div_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r10 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r10.key[4] ? ctx_r10.key[4] : \" \");\n  }\n}\nfunction LoginComponent_div_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 9);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r11 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r11.key[5] ? ctx_r11.key[5] : \" \");\n  }\n}\nfunction LoginComponent_div_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r12 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r12.key[5] ? ctx_r12.key[5] : \" \");\n  }\n}\nexport let LoginComponent = /*#__PURE__*/(() => {\n  class LoginComponent {\n    constructor(router, api, dialog, route, cookieService, matFormField, snackBar) {\n      var _this = this;\n      this.router = router;\n      this.api = api;\n      this.dialog = dialog;\n      this.route = route;\n      this.cookieService = cookieService;\n      this.matFormField = matFormField;\n      this.snackBar = snackBar;\n      this.key = \"\";\n      this.getCodeChar = index => {\n        if (this.key.length > index) {\n          return this.key.charAt(index);\n        }\n        return \"\";\n      };\n      this.goToCameraControl = /*#__PURE__*/_asyncToGenerator(function* () {\n        _this.api.getControlInfo(_this.key).subscribe(info => {\n          _this.snackBar.dismiss();\n          return _this.router.navigate([\"/control/\" + info.room], {\n            queryParams: {\n              controlGroup: info.controlGroup\n            }\n          });\n        }, err => {\n          let msg = err.error;\n          switch (err.status) {\n            case 401:\n              msg = \"Invalid room code\";\n            default:\n          }\n          _this.showError(msg);\n        });\n        _this.key = \"\";\n      });\n    }\n    ngOnInit() {\n      this.keyboardEmitter = new EventEmitter();\n      this.keyboardEmitter.subscribe(s => {\n        if (s === \"done\") {\n          this.goToCameraControl();\n        } else {\n          this.key = s;\n        }\n      });\n      document.title = \"BYU Camera Control\";\n    }\n    ngAfterViewInit() {\n      this.form.nativeElement.focus();\n      const decoder = new JwtHelperService();\n      var decoded = decoder.decodeToken(this.cookieService.get(\"camera-services-control\"));\n      if (decoded != null && Object.keys(decoded.rooms).length > 0) {\n        var room = this.findMostRecentRoom(decoded.rooms);\n        let snackBarRef = this.snackBar.open(\"Would you like to go back to \" + room.name + \"?\", \"GO\", {\n          duration: 30000\n        });\n        snackBarRef.onAction().subscribe(() => {\n          this.router.navigate([\"/control/\" + room.name], {\n            queryParams: {\n              controlGroup: room.controlGroup.name\n            }\n          });\n        });\n      }\n    }\n    _focus() {\n      this.form.nativeElement.focus();\n    }\n    hasFocus() {\n      return document.hasFocus();\n    }\n    showError(msg) {\n      const dialogs = this.dialog.openDialogs.filter(dialog => {\n        return dialog.componentInstance instanceof ErrorDialog;\n      });\n      if (dialogs.length > 0) {\n        return;\n      }\n      this.dialog.open(ErrorDialog, {\n        width: \"fit-content\",\n        data: {\n          msg: msg\n        }\n      });\n    }\n    findMostRecentRoom(rooms) {\n      var mostRecent;\n      for (const [room, val] of Object.entries(rooms)) {\n        for (const [preset, time] of Object.entries(val)) {\n          if (mostRecent === undefined || mostRecent.controlGroup.time < time) {\n            mostRecent = new Room(room, new ControlGroup(preset, time));\n          }\n        }\n      }\n      return mostRecent;\n    }\n    static #_ = this.ɵfac = function LoginComponent_Factory(t) {\n      return new (t || LoginComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.APIService), i0.ɵɵdirectiveInject(i3.MatDialog), i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i4.CookieService), i0.ɵɵdirectiveInject(i5.MatFormFieldModule), i0.ɵɵdirectiveInject(i6.MatSnackBar));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: LoginComponent,\n      selectors: [[\"app-login\"]],\n      viewQuery: function LoginComponent_Query(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵviewQuery(_c0, 5);\n        }\n        if (rf & 2) {\n          let _t;\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.form = _t.first);\n        }\n      },\n      decls: 23,\n      vars: 14,\n      consts: [[1, \"column\", 3, \"click\"], [\"src\", \"../assets/logo.svg\", 1, \"logo\"], [2, \"margin-top\", \"5%\"], [\"matInput\", \"\", \"inputmode\", \"numeric\", \"maxlength\", \"6\", \"autocomplete\", \"off\", 1, \"input-field\", 3, \"ngModel\", \"ngModelChange\", \"keyup.enter\"], [\"form\", \"\"], [1, \"room-code\"], [\"class\", \"code-char-selected\", 4, \"ngIf\"], [\"class\", \"code-char\", 4, \"ngIf\"], [\"mat-stroked-button\", \"\", \"color\", \"primary\", 1, \"sign-in\", 3, \"disableRipple\", \"click\"], [1, \"code-char-selected\"], [1, \"code-char\"]],\n      template: function LoginComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0);\n          i0.ɵɵlistener(\"click\", function LoginComponent_Template_div_click_0_listener() {\n            return ctx._focus();\n          });\n          i0.ɵɵelementContainerStart(1);\n          i0.ɵɵelement(2, \"img\", 1);\n          i0.ɵɵelementStart(3, \"span\", 2);\n          i0.ɵɵtext(4, \"Enter Control Key:\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(5, \"mat-form-field\")(6, \"input\", 3, 4);\n          i0.ɵɵlistener(\"ngModelChange\", function LoginComponent_Template_input_ngModelChange_6_listener($event) {\n            return ctx.key = $event;\n          })(\"keyup.enter\", function LoginComponent_Template_input_keyup_enter_6_listener() {\n            return ctx.goToCameraControl();\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(8, \"div\", 5);\n          i0.ɵɵtemplate(9, LoginComponent_div_9_Template, 2, 1, \"div\", 6)(10, LoginComponent_div_10_Template, 2, 1, \"div\", 7)(11, LoginComponent_div_11_Template, 2, 1, \"div\", 6)(12, LoginComponent_div_12_Template, 2, 1, \"div\", 7)(13, LoginComponent_div_13_Template, 2, 1, \"div\", 6)(14, LoginComponent_div_14_Template, 2, 1, \"div\", 7)(15, LoginComponent_div_15_Template, 2, 1, \"div\", 6)(16, LoginComponent_div_16_Template, 2, 1, \"div\", 7)(17, LoginComponent_div_17_Template, 2, 1, \"div\", 6)(18, LoginComponent_div_18_Template, 2, 1, \"div\", 7)(19, LoginComponent_div_19_Template, 2, 1, \"div\", 6)(20, LoginComponent_div_20_Template, 2, 1, \"div\", 7);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(21, \"button\", 8);\n          i0.ɵɵlistener(\"click\", function LoginComponent_Template_button_click_21_listener() {\n            return ctx.goToCameraControl();\n          });\n          i0.ɵɵtext(22, \" Enter \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementContainerEnd();\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngModel\", ctx.key);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngIf\", (ctx.key == null ? null : ctx.key.length) == 0 && ctx.hasFocus());\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", (ctx.key == null ? null : ctx.key.length) != 0 || !ctx.hasFocus());\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", (ctx.key == null ? null : ctx.key.length) == 1 && ctx.hasFocus());\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", (ctx.key == null ? null : ctx.key.length) != 1 || !ctx.hasFocus());\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", (ctx.key == null ? null : ctx.key.length) == 2 && ctx.hasFocus());\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", (ctx.key == null ? null : ctx.key.length) != 2 || !ctx.hasFocus());\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", (ctx.key == null ? null : ctx.key.length) == 3 && ctx.hasFocus());\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", (ctx.key == null ? null : ctx.key.length) != 3 || !ctx.hasFocus());\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", (ctx.key == null ? null : ctx.key.length) == 4 && ctx.hasFocus());\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", (ctx.key == null ? null : ctx.key.length) != 4 || !ctx.hasFocus());\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", (ctx.key == null ? null : ctx.key.length) == 5 && ctx.hasFocus());\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", (ctx.key == null ? null : ctx.key.length) != 5 || !ctx.hasFocus());\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"disableRipple\", true);\n        }\n      },\n      dependencies: [i7.NgIf, i5.MatFormField, i8.MatButton, i9.DefaultValueAccessor, i9.NgControlStatus, i9.MaxLengthValidator, i9.NgModel, i10.MatInput],\n      styles: [\".logo[_ngcontent-%COMP%]{height:30%;width:30%;display:flex;justify-content:center;align-items:center;pointer-events:none;margin-top:5%}.column[_ngcontent-%COMP%]{display:flex;flex-flow:column nowrap;height:100%;width:100vw!important;justify-content:flex-start;align-items:center;font-size:22pt;color:#757575;overflow:visible;margin-left:0;margin-right:0}.sign-in[_ngcontent-%COMP%]{margin-top:3%;transform:scale(2)}.room-code[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;justify-content:space-between;min-height:30px;height:30px}.code-char[_ngcontent-%COMP%]{width:20px;border-block-end:1px solid black;min-height:30px;height:30px}.code-char-selected[_ngcontent-%COMP%]{width:20px;border-block-end:1px solid black;min-height:30px;height:30px;animation:_ngcontent-%COMP%_blinkingText .8s infinite}@keyframes _ngcontent-%COMP%_blinkingText{0%{border-color:#000}49%{border-color:transparent}50%{border-color:transparent}99%{border-color:transparent}to{border-color:#000}}  .mat-form-field-underline{display:none}.loadingText[_ngcontent-%COMP%]{margin:5vh 0}@media (min-width: 768px){.code-char[_ngcontent-%COMP%]{width:20px;border-block-end:1px solid black;min-height:30px;height:30px}.logo[_ngcontent-%COMP%]{height:25%;width:25%;margin:25px}}.input-field[_ngcontent-%COMP%]{width:14vw;margin-left:.8vw;position:absolute;letter-spacing:1vw;opacity:0}\"]\n    });\n  }\n  return LoginComponent;\n})();\nexport class Room {\n  constructor(name, controlGroup) {\n    this.name = name;\n    this.controlGroup = controlGroup;\n  }\n}\nexport class ControlGroup {\n  constructor(name, time) {\n    this.name = name;\n    this.time = time;\n  }\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}